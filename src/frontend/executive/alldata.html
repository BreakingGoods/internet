<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard</title>
  <link rel="stylesheet" href="alldatastyle.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- Bootstrap JS (‡∏û‡∏£‡πâ‡∏≠‡∏° Popper.js) -->
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js"></script>

  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;

    }

    .content-area {

      margin-left: 290px;
      /* Matches the sidebar's width */
      padding: 20px;
      background-color: #f8f9fa;
      min-height: 100vh;
      /* Ensure the content area stretches to full height */
    }

    /* Responsive: ‡∏à‡∏≠‡πÄ‡∏•‡πá‡∏Å */
    @media (max-width: 576px) {
      .sidebar {
        position: relative;
        width: 100%;
        box-shadow: none;
      }

      .content-area {
        margin-left: 0;
      }
    }

    .sidebar .btn:last-child {
      margin-top: auto;
      /* ‡∏î‡∏±‡∏ô‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏•‡πà‡∏≤‡∏á‡∏™‡∏∏‡∏î */
    }

    .canvas {
      width: 100%;
      /* Expand canvas width */
      max-width: 600px;
      /* Optional: Set a max width */
      height: 500px;
      /* Increase height for better vertical display */
    }
  </style>
</head>

<body>
<div id="sidebar-container"></div>
  <div class="content-area">
    <!-- ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÉ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å Sidebar ‡∏ó‡∏±‡∏ö -->
    <div class="container" onclick="window.location.href='detailroom.html';">
      <section class="charts">
        <div class="chart-header">
          <h3 class="most-room" style="font-weight: bold;">‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÄ‡∏¢‡∏≠‡∏∞‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</h3>
        </div>
        <div style="display: flex; justify-content: space-around; align-items: center; flex-wrap: wrap;">
          <!-- Bar Chart -->
          <div style="width: 600px; height: 300px; margin-top: 40px;">
            <canvas id="barChart"></canvas>
          </div>
        </div>
      </section>
    </div>


    <div class="container-two">
      <section class="graph">
        <div class="graph-container">
          <div>
            <h3 class="graph-header">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô‡∏à‡∏≠‡∏á
              <div class="dropdown d-inline">
                <i class="bi bi-caret-down-fill" type="button" data-bs-toggle="dropdown" aria-expanded="false" style="color: #929292; font-size: 10px;">
                </i>
                <ul class="dropdown-menu">
                    <li><a class="dropdown-item" href="#">Week</a></li>
                    <li><a class="dropdown-item" href="#">Mouth</a></li>
                    <li><a class="dropdown-item" href="#">Year</a></li>
                </ul>
              </div>
            </h3>
          </div>
          <div>
            <canvas id="LineChart"></canvas>
          </div>
          <br><button onclick="window.location.href='grap.html'" style="border-radius: 5px;">Details</button>
        </div>
      </section>

      <section class="equipment">
        <div class="equip-container">
          <div>
            <h3 class="graph-header" style="text-align: center;">‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå
              <div class="dropdown d-inline">
                <i class="bi bi-caret-down-fill" type="button" data-bs-toggle="dropdown" aria-expanded="false" style="color: #929292; font-size: 10px;">
                </i>
                <ul class="dropdown-menu">
                    <li><a class="dropdown-item" href="#">‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°</a></li>
                    <li><a class="dropdown-item" href="#">‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏¢‡∏∑‡∏°</a></li>
                </ul>
              </div>
            </h3>
          </div>
          <div onclick="window.location.href='broken_equipment.html';" style="cursor: pointer;">
            <div style="width: auto; height: auto;">
              <canvas id="doughnutChart1"></canvas>
            </div>
          </div>
          <div onclick="window.location.href='borrow_equipment.html';"style="cursor: pointer;">
            <div style="width: auto; height: auto;">
              <canvas id="doughnutChart2"></canvas>
            </div>
          </div>
          <button onclick="window.location.href='eqiup.html'" style="border-radius: 5px;">Details</button>
      </section>
    </div>

    <div class="container-three">
        <section class="moststuden-container">
          <div>
            <h3 class="moststuden-header">‡∏ô‡∏¥‡∏™‡∏¥‡∏ï‡∏ó‡∏µ‡πà‡∏à‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏´‡πâ‡∏≠‡∏á‡∏ö‡πà‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</h3>
          </div>
          <div>
            <section>
              <div class="split-container">
                <p3>‡∏ô‡∏≤‡∏¢ ‡∏Ñ‡∏≥‡∏°‡∏µ ‡∏™‡∏≤‡πÄ‡∏Å</p3>
                <p4>5 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</p4>
              </div>
              <br>
              <div class="split-container">
                <p3>‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß ‡∏≠‡∏∏‡πâ‡∏á‡∏≠‡∏¥‡πâ‡∏á ‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£</p3>
                <p4>3 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</p4>
              </div>
              <br>
              <div class="split-container">
                <p3>‡∏ô‡∏≤‡∏¢ ‡∏ò‡∏µ‡∏£‡∏û‡∏á‡∏©‡πå ‡∏û‡∏≤‡∏™‡∏∏‡∏Ç</p3>
                <p4>2 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</p4>
              </div>
            </section>
            <button onclick="window.location.href='student.html';" style="border-radius: 5px;">Details</button>
          </div>
        </section>

        <section class="moststuden-container">
          <div>
            <h3 class="moststuden-header">‡∏ô‡∏¥‡∏™‡∏¥‡∏ï‡∏ó‡∏µ‡πà‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ö‡πà‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</h3>
          </div>
          <div>
            <section>
              <div class="split-container">
                <p3>‡∏ô‡∏≤‡∏¢ ‡∏Ñ‡∏≥‡∏°‡∏µ ‡∏™‡∏≤‡πÄ‡∏Å</p3>
                <p4>3 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</p4>
              </div>
              <br>
              <div class="split-container">
                <p3>‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß ‡∏≠‡∏∏‡πâ‡∏á‡∏≠‡∏¥‡πâ‡∏á ‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£</p3>
                <p4>2 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</p4>
              </div>
              <br>
              <div class="split-container">
                <p3>‡∏ô‡∏≤‡∏¢ ‡∏ò‡∏µ‡∏£‡∏û‡∏á‡∏©‡πå ‡∏û‡∏≤‡∏™‡∏∏‡∏Ç</p3>
                <p4>1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</p4>
              </div>
            </section>
            <button onclick="window.location.href='student.html';" style="border-radius: 5px;">Details</button>
          </div>
        </section>

      </section>
    </div> 
  </div>
  <script>
    // fetch sidebar
    fetch("sidebar.html")
        .then((resp) => resp.text())
        .then((html) => {
          // ‡πÅ‡∏ó‡∏£‡∏Å Sidebar ‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤
          document.getElementById("sidebar-container").innerHTML = html;
        })
        .then(() => {
          // ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡∏±‡∏ß Sidebar ‡∏ñ‡∏π‡∏Å‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡πÉ‡∏ô DOM ‡πÅ‡∏•‡πâ‡∏ß
          // ‡πÉ‡∏´‡πâ Highlight ‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥
          const btnStats = document.getElementById("btnStatistic");
          btnStats.classList.add("btn-sidebar-active");
        })
        .catch((err) => console.error("Failed to load sidebar:", err));
      // end of fetch sidebar
    // Bar Chart Data
    fetch('http://localhost:3000/mostroomalldata')
        .then(response => {
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }
          return response.json();
        })
        .then(data => {
          console.log("Fetched Data:", data); // üõ† Debug: ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• API

          const barCtx = document.getElementById('barChart').getContext('2d');
          if (!barCtx) {
            console.error("Canvas element not found!");
            return;
          }

          // Prepare data for the Chart.js chart after fetching
          const labels = data.map(item => `Room ${item.room}`);
          const totalCount = data.map(item => item.count);
          const csCount = data.map(item => item.cs  );
          const itCount = data.map(item => item.it );

          new Chart(barCtx, {
            type: 'bar',
            data: {
              labels: labels,
              datasets: [
                {
                  label: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡∏¥‡∏™‡∏¥‡∏ï‡∏£‡∏ß‡∏°',
                  data: totalCount,
                  backgroundColor: '#E5D2BA'
                },
                {
                  label: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡∏¥‡∏™‡∏¥‡∏ï ‡∏™‡∏≤‡∏Ç‡∏≤ ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≠‡∏°‡∏Ø',
                  data: csCount,
                  backgroundColor: '#E54715'
                },
                {
                  label: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡∏¥‡∏™‡∏¥‡∏ï ‡∏™‡∏≤‡∏Ç‡∏≤‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏Ø',
                  data: itCount,
                  backgroundColor: '#622BBE'
                }
              ]
            },
            options: {
              responsive: true,
              plugins: {
                legend: {
                  position: 'bottom' // Position legend at the bottom
                },
                title: {
                  display: true,
                  text: '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡∏¥‡∏™‡∏¥‡∏ï'
                }
              },
              scales: {
                y: {
                  beginAtZero: true
                }
              }
            }
          });
        })
        .catch(error => {
          console.error('Error fetching data:', error);
        });
    // Doughnut Chart 1 Data
  fetch('http://localhost:3000/brokendEquipment')
    .then(response => {
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        return response.json();
    })
    .then(data => {
        console.log("Fetched Data:", data); // üõ† Debug: ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• API
        
        const doughnutCtx1 = document.getElementById('doughnutChart1');


        if (!doughnutCtx1) {
            console.error("Canvas element donut not found!");
            return;
        }

        new Chart(doughnutCtx1.getContext('2d'), {  // ‚úÖ ‡πÉ‡∏ä‡πâ .getContext('2d') ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
            type: 'doughnut',
            data: {
                labels: data.map(item => item.Equipments_name), // ‚úÖ ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏µ‡∏¢‡πå‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
                datasets: [{
                    data: data.map(item => item.count),
                    backgroundColor: ['#E5D2BA', '#E54715', '#622BBE'], // ‚úÖ ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡∏µ
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: { position: 'bottom' },
                    title: { display: true, text: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏µ‡∏¢' }
                }
            }
        });
    })
    .catch(error => {
        console.error("‚ùå Error fetching data:", error);
    });
    




    // Doughnut Chart 2 Data
    fetch('http://localhost:3000/borrowEquipment')
    .then(response => {
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        return response.json();
    })
    .then(data => {
        console.log("Fetched Data:", data); // üõ† Debug: ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• API
        
        const doughnutCtx2 = document.getElementById('doughnutChart2');


        if (!doughnutCtx2) {
            console.error("Canvas element donut not found!");
            return;
        }

        new Chart(doughnutCtx2.getContext('2d'), {  // ‚úÖ ‡πÉ‡∏ä‡πâ .getContext('2d') ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
            type: 'doughnut',
            data: {
                labels: data.map(item => item.Equipments_name), // ‚úÖ ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏µ‡∏¢‡πå‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
                datasets: [{
                    data: data.map(item => item.count),
                    backgroundColor: ['#E5D2BA', '#E54715', '#622BBE'], // ‚úÖ ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡∏µ
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: { position: 'bottom' },
                    title: { display: true, text: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏µ‡∏¢' }
                }
            }
        });
    })
    .catch(error => {
        console.error("‚ùå Error fetching data:", error);
    });
    const Linectx = document.getElementById('LineChart').getContext('2d');

// ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô‡∏Å‡∏£‡∏≤‡∏ü
const data = {
  labels: ['January', 'February', 'March', 'April', 'May', 'June', 'July'], // ‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤ (x-axis)
  datasets: [
    {
      label: 'Dataset 1', // ‡∏ä‡∏∑‡πà‡∏≠ dataset ‡πÅ‡∏£‡∏Å
      data: [65, 59, 80, 81, 56, 55, 40], // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡∏Ç‡∏≠‡∏á dataset ‡∏ô‡∏µ‡πâ
      borderColor: '#622b86', // ‡∏™‡∏µ‡πÄ‡∏™‡πâ‡∏ô
      backgroundColor: '#622b86', // ‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏Ç‡∏≠‡∏á‡∏à‡∏∏‡∏î‡πÉ‡∏ô‡∏Å‡∏£‡∏≤‡∏ü
     
    },
    {
      label: 'Dataset 2', // ‡∏ä‡∏∑‡πà‡∏≠ dataset ‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏á
      data: [28, 48, 40, 19, 86, 27, 90], // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á dataset ‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏á
      borderColor: '#E54715', // ‡∏™‡∏µ‡πÄ‡∏™‡πâ‡∏ô
      backgroundColor: '#E54715', // ‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏Ç‡∏≠‡∏á‡∏à‡∏∏‡∏î‡πÉ‡∏ô‡∏Å‡∏£‡∏≤‡∏ü
     
    }
  ]
};

// ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏≤‡∏ü‡πÉ‡∏´‡∏°‡πà‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ Chart.js
new Chart(Linectx, {
  type: 'line', // ‡∏£‡∏∞‡∏ö‡∏∏‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏£‡∏≤‡∏ü‡πÄ‡∏õ‡πá‡∏ô line chart
  data: data, // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏£‡∏≤‡∏ü
  options: {
    responsive: true, // ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Å‡∏£‡∏≤‡∏ü‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠
    plugins: {
      legend: {
        position: 'top', // ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á legend
      },
      title: {
        display: true, // ‡πÅ‡∏™‡∏î‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏£‡∏≤‡∏ü
        text: 'Line Chart Example', // ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏£‡∏≤‡∏ü
      }
    }
  },
});
  </script>
</body>

</html>